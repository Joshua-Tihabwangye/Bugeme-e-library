import{j as e,L as o,b as d}from"./index-C_R6iRdk.js";import{u as n}from"./useQuery-DjejrF76.js";import{r as h}from"./react-vendor-BXWpoY3z.js";import{D as p,f as u,u as j,U as b,v as N}from"./ui-vendor-DTvEXM4H.js";const l=t=>new Intl.NumberFormat("en-UG",{style:"currency",currency:"UGX",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),k=()=>{const[t,c]=h.useState("all"),{data:r,isLoading:x}=n({queryKey:["admin-subscription-revenue"],queryFn:async()=>{const{data:s}=await d.get("/subscriptions/admin/revenue/");return s},staleTime:60*1e3}),{data:i=[],isLoading:m}=n({queryKey:["admin-subscription-list",t],queryFn:async()=>{const s=t!=="all"?`?period=${t}`:"",{data:a}=await d.get(`/subscriptions/admin/list/${s}`);return Array.isArray(a)?a:a&&Array.isArray(a.results)?a.results:[]},staleTime:30*1e3});return x||m?e.jsx(o,{label:"Loading subscriptions"}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-brand-500 dark:text-brand-300",children:"Admin"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900 dark:text-white",children:"Subscription Management"}),e.jsx("p",{className:"mt-1 text-slate-600 dark:text-slate-400",children:"Track revenue and manage subscriber accounts"})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"stat-card-emerald",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase text-emerald-600 dark:text-emerald-400",children:"Today"}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-slate-900 dark:text-white",children:l(r?.revenue_today||0)})]}),e.jsx("div",{className:"rounded-xl bg-emerald-500/10 p-3",children:e.jsx(p,{className:"h-6 w-6 text-emerald-500"})})]})}),e.jsx("div",{className:"stat-card-blue",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase text-blue-600 dark:text-blue-400",children:"This Month"}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-slate-900 dark:text-white",children:l(r?.revenue_month||0)})]}),e.jsx("div",{className:"rounded-xl bg-blue-500/10 p-3",children:e.jsx(u,{className:"h-6 w-6 text-blue-500"})})]})}),e.jsx("div",{className:"stat-card-violet",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase text-violet-600 dark:text-violet-400",children:"This Year"}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-slate-900 dark:text-white",children:l(r?.revenue_year||0)})]}),e.jsx("div",{className:"rounded-xl bg-violet-500/10 p-3",children:e.jsx(j,{className:"h-6 w-6 text-violet-500"})})]})}),e.jsx("div",{className:"stat-card-amber",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase text-amber-600 dark:text-amber-400",children:"Active Subscribers"}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-slate-900 dark:text-white",children:r?.active_subscribers||0})]}),e.jsx("div",{className:"rounded-xl bg-amber-500/10 p-3",children:e.jsx(b,{className:"h-6 w-6 text-amber-500"})})]})})]}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-6 py-4 dark:border-white/5",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"All Subscriptions"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4 text-slate-500"}),e.jsxs("select",{value:t,onChange:s=>c(s.target.value),className:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 focus:border-brand-500 focus:outline-none dark:border-white/10 dark:bg-slate-800 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"year",children:"This Year"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm text-slate-600 dark:text-slate-400",children:[e.jsx("thead",{className:"bg-slate-100 text-xs uppercase text-slate-600 dark:bg-slate-900/50 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Subscriber"}),e.jsx("th",{className:"px-6 py-3",children:"Plan"}),e.jsx("th",{className:"px-6 py-3",children:"Status"}),e.jsx("th",{className:"px-6 py-3",children:"Amount"}),e.jsx("th",{className:"px-6 py-3",children:"Duration"}),e.jsx("th",{className:"px-6 py-3",children:"Expires"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-white/5",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-slate-500",children:"No subscriptions found"})}):i.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-white/5",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:s.user_name}),e.jsx("div",{className:"text-xs text-slate-500",children:s.user_email})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"font-medium",children:s.plan_name||"N/A"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.is_active?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:s.is_active?"Active":"Expired"})}),e.jsx("td",{className:"px-6 py-4 font-medium",children:l(parseFloat(s.amount_paid))}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"rounded bg-slate-100 px-2 py-1 text-xs dark:bg-slate-800",children:s.plan_duration||"N/A"})}),e.jsx("td",{className:"px-6 py-4",children:s.end_date?new Date(s.end_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"})]},s.id))})]})})]})]})};export{k as default};
