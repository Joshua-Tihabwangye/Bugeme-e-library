import{u as b}from"./useQuery-DjejrF76.js";import{g as y}from"./subscriptions-D2v3T0Hl.js";import{u as f}from"./index-C_R6iRdk.js";const w=()=>{const s=f(e=>e.user),a=s!==null&&!s.registration_number&&!s.staff_id,{data:t,isLoading:l}=b({queryKey:["my-subscription"],queryFn:y,enabled:!!s,staleTime:60*1e3,retry:!1}),n=t?.is_valid===!0,m=a&&!n;let r=null,i=0,o=null;if(t?.end_date&&t?.start_date){const e=new Date(t.end_date),u=new Date(t.start_date),c=new Date;o=e,r=e.getTime()-c.getTime();const p=e.getTime()-u.getTime(),g=c.getTime()-u.getTime();i=Math.min(100,Math.max(0,g/p*100))}const d=n&&i>=80;return{subscription:t||null,isLoading:l,hasActiveSubscription:n,isVisitor:a,needsSubscription:m,timeRemaining:r,percentElapsed:i,showRenewalWarning:d,expiryDate:o}};export{w as u};
