import{v as y,z as n,j as e,d as j}from"./index-BrKjOGpc.js";import{u as v,t as N,o as w,s as C}from"./types-BXF7fmc6.js";import{e as L,u as S,r as o,L as R}from"./react-vendor-BXWpoY3z.js";import"./ui-vendor-DIXPZkrp.js";const $=w({code:C().regex(/^\d{6}$/,"Code must be 6 digits")}),M=()=>{const d=L(),r=S().state?.email||"",[i,c]=o.useState(!1),[x,m]=o.useState(!1),[s,u]=o.useState(120);o.useEffect(()=>{if(s<=0)return;const t=setInterval(()=>{u(a=>a-1)},1e3);return()=>clearInterval(t)},[s]),o.useEffect(()=>{r||d("/forgot-password")},[r,d]);const{register:p,handleSubmit:h,formState:{errors:f}}=v({resolver:N($)}),b=h(async t=>{c(!0);try{await y(r,t.code),n.success("Code verified successfully"),d("/new-password",{state:{email:r,code:t.code}})}catch(a){const l=a.response?.data?.error||"Invalid or expired code";n.error(l)}finally{c(!1)}}),g=async()=>{m(!0);try{await j(r),n.success("New code sent to your email"),u(120)}catch{n.error("Failed to resend code. Please try again.")}finally{m(!1)}},k=t=>{const a=Math.floor(t/60),l=t%60;return`${a}:${l.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900 dark:text-white",children:"Enter Verification Code"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["We sent a 6-digit code to ",e.jsx("span",{className:"font-semibold",children:r})]})]}),e.jsxs("div",{className:`flex items-center justify-center gap-2 rounded-lg p-3 ${s>0?"bg-amber-50 dark:bg-amber-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[e.jsx("svg",{className:"h-5 w-5 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:`text-sm font-medium ${s>0?"text-amber-700 dark:text-amber-300":"text-red-700 dark:text-red-300"}`,children:s>0?`Code expires in ${k(s)}`:"Code expired - request a new one"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-400",children:"Verification Code"}),e.jsx("input",{type:"text",...p("code"),placeholder:"000000",maxLength:6,disabled:i,className:"mt-2 w-full rounded-xl border border-slate-300 bg-white px-4 py-2 text-center text-2xl font-mono tracking-widest text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 dark:border-white/10 dark:bg-slate-900 dark:text-white disabled:opacity-50"}),f.code&&e.jsx("p",{className:"text-xs text-red-400",children:f.code.message})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full",disabled:i||s<=0,children:i?"Verifying...":"Verify Code"})]}),e.jsxs("div",{className:"space-y-2 text-center text-sm",children:[e.jsx("button",{type:"button",onClick:g,disabled:x,className:"font-semibold text-sky-700 underline underline-offset-2 hover:text-sky-800 dark:text-sky-300 dark:hover:text-sky-200 disabled:opacity-50",children:x?"Sending...":"Resend Code"}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-400",children:["or"," ",e.jsx(R,{to:"/login",className:"font-semibold text-sky-700 underline underline-offset-2 hover:text-sky-800 dark:text-sky-300 dark:hover:text-sky-200",children:"Back to Login"})]})]})]})};export{M as default};
