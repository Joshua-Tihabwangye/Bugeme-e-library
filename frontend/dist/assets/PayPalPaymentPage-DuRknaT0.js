import{j as e,z as d}from"./index-BrKjOGpc.js";import{h as p,e as y,r as o,L as h}from"./react-vendor-BXWpoY3z.js";import{u as b}from"./useQuery-BaEuwe5n.js";import{u as f}from"./useMutation-DBZgN-6u.js";import{c as k,a as g}from"./subscriptions-CKR5TxXt.js";import{d as j,u as P,W as N,t as w,w as v}from"./ui-vendor-DIXPZkrp.js";const R=()=>{const{planId:r}=p(),c=y(),[s,m]=o.useState(""),[t,l]=o.useState("input"),{data:i}=b({queryKey:["subscription-plans"],queryFn:g,staleTime:5*60*1e3,gcTime:10*60*1e3}),a=(Array.isArray(i)?i:[]).find(n=>n.id===Number(r)),x=f({mutationFn:k,onSuccess:()=>{l("success"),setTimeout(()=>c("/"),3e3)},onError:()=>{d.error("Payment failed. Please try again."),l("input")}}),u=()=>{if(!s||!s.includes("@")){d.error("Please enter a valid email address");return}l("processing"),setTimeout(()=>{x.mutate({plan_id:Number(r),payment_method:"PAYPAL"})},3e3)};return t==="success"?e.jsxs("div",{className:"mx-auto max-w-md py-16 text-center animate-in",children:[e.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-500/20",children:e.jsx(j,{className:"h-10 w-10 text-emerald-600 dark:text-emerald-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Payment Successful!"}),e.jsxs("p",{className:"mt-2 text-slate-600 dark:text-slate-400",children:["Your ",a?.name," subscription is now active. Redirecting..."]})]}):e.jsxs("div",{className:"mx-auto max-w-md space-y-6 py-8 animate-in",children:[e.jsxs(h,{to:`/subscription/payment/${r}`,className:"inline-flex items-center gap-2 text-sm font-medium text-slate-600 hover:text-brand-600 dark:text-slate-400",children:[e.jsx(P,{className:"h-4 w-4"}),"Back to payment options"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-sky-400 to-sky-500",children:e.jsx(N,{className:"h-8 w-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"PayPal Payment"}),e.jsxs("p",{className:"mt-2 text-slate-600 dark:text-slate-400",children:["Pay UGX ",a?Number(a.price).toLocaleString():"---"," for ",a?.name]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white px-6 py-3 dark:border-white/10 dark:bg-slate-800",children:e.jsxs("span",{className:"text-xl font-bold",children:[e.jsx("span",{className:"text-sky-600",children:"Pay"}),e.jsx("span",{className:"text-sky-800 dark:text-sky-400",children:"Pal"})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"PayPal Email"}),e.jsx("input",{type:"email",value:s,onChange:n=>m(n.target.value),placeholder:"your-email@example.com",disabled:t==="processing",className:"w-full rounded-xl border border-slate-300 px-4 py-3 text-slate-900 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500/20 dark:border-white/10 dark:bg-slate-900 dark:text-white disabled:opacity-50"}),e.jsx("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:"You'll be redirected to PayPal to complete your payment"})]}),e.jsx("button",{onClick:u,disabled:t==="processing"||!s,className:"w-full rounded-xl bg-gradient-to-r from-sky-400 to-sky-500 py-3 font-semibold text-white shadow-lg transition hover:shadow-xl disabled:opacity-50 flex items-center justify-center gap-2",children:t==="processing"?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-5 w-5 animate-spin"}),"Connecting to PayPal..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4"}),"Pay with PayPal"]})})]}),t==="processing"&&e.jsx("div",{className:"rounded-xl bg-sky-50 p-4 text-center dark:bg-sky-500/10",children:e.jsx("p",{className:"text-sm text-sky-700 dark:text-sky-300",children:"Please complete the payment in the PayPal window. Do not close this page."})}),e.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 dark:border-white/10 dark:bg-slate-800/50",children:e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 text-center",children:"PayPal protects your financial information with industry-leading security."})})]})};export{R as default};
