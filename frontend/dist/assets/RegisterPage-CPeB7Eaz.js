import{u as N,j as e,r as j,z as m}from"./index-C_R6iRdk.js";import{u as S}from"./useMutation-Com-Be19.js";import{u as T,t as _,o as v,e as E,s as i}from"./types-BXF7fmc6.js";import{r as d,e as P,L as u}from"./react-vendor-BXWpoY3z.js";import{E as p,n as h}from"./ui-vendor-DTvEXM4H.js";const F=v({name:i().min(3,"Name must be at least 3 characters"),email:i().email("Invalid email address"),password:i().min(8,"Password must be at least 8 characters"),password_confirm:i().min(8,"Password must be at least 8 characters"),registration_number:i().optional(),staff_id:i().optional(),account_type:E(["STUDENT","STAFF"])}).refine(s=>s.password===s.password_confirm,{message:"Passwords must match",path:["password_confirm"]}).refine(s=>!(s.account_type==="STUDENT"&&!s.registration_number||s.account_type==="STAFF"&&!s.staff_id),{message:"ID Number is required",path:["registration_number"]}),R=()=>{const[s,b]=d.useState(!1),[n,f]=d.useState(!1),[o,c]=d.useState("STUDENT"),g=P();N(a=>a.setSession);const{register:l,handleSubmit:w,setValue:x,formState:{errors:t}}=T({resolver:_(F),defaultValues:{account_type:"STUDENT"}}),r=S({mutationFn:j,onSuccess:()=>{m.success("Account created successfully! Please sign in."),g("/login")},onError:a=>{const k=a?.response?.data?.error||"Registration failed";m.error(k)}}),y=w(a=>{a.account_type==="STUDENT"&&(a.staff_id=""),a.account_type==="STAFF"&&(a.registration_number=""),r.mutate(a)});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900 dark:text-white",children:"Create account"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Join Bugema E-Library as Student or Staff."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 rounded-xl bg-slate-100 p-1 dark:bg-white/5",children:[e.jsx("button",{type:"button",onClick:()=>{c("STUDENT"),x("account_type","STUDENT")},className:`rounded-lg px-4 py-2 text-sm font-medium transition-all ${o==="STUDENT"?"bg-white text-slate-900 shadow-sm dark:bg-slate-800 dark:text-white":"text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white"}`,children:"Student"}),e.jsx("button",{type:"button",onClick:()=>{c("STAFF"),x("account_type","STAFF")},className:`rounded-lg px-4 py-2 text-sm font-medium transition-all ${o==="STAFF"?"bg-white text-slate-900 shadow-sm dark:bg-slate-800 dark:text-white":"text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white"}`,children:"Staff Member"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Full name"}),e.jsx("input",{...l("name"),disabled:r.isPending,className:"mt-2 w-full rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 dark:border-white/10 dark:bg-slate-900 dark:text-white disabled:opacity-50",placeholder:"John Doe"}),t.name&&e.jsx("p",{className:"text-xs text-red-400",children:t.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:o==="STUDENT"?"Registration Number":"Staff ID Number"}),e.jsx("input",{...l(o==="STUDENT"?"registration_number":"staff_id"),disabled:r.isPending,className:"mt-2 w-full rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 dark:border-white/10 dark:bg-slate-900 dark:text-white disabled:opacity-50",placeholder:o==="STUDENT"?"22/BSE/BU/R/0000":"STF/BU/000"}),(t.registration_number||t.staff_id)&&e.jsx("p",{className:"text-xs text-red-400",children:t.registration_number?.message||t.staff_id?.message||"ID Number is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Email"}),e.jsx("input",{type:"email",...l("email"),disabled:r.isPending,className:"mt-2 w-full rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 dark:border-white/10 dark:bg-slate-900 dark:text-white disabled:opacity-50",placeholder:"john@example.com"}),t.email&&e.jsx("p",{className:"text-xs text-red-400",children:t.email.message})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:s?"text":"password",...l("password"),disabled:r.isPending,className:"mt-2 w-full rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 dark:border-white/10 dark:bg-slate-900 dark:text-white disabled:opacity-50"}),e.jsx("button",{type:"button",onClick:()=>b(!s),className:"absolute right-3 top-[18px] text-slate-400 hover:text-white",children:s?e.jsx(p,{size:16}):e.jsx(h,{size:16})})]}),t.password&&e.jsx("p",{className:"text-xs text-red-400",children:t.password.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Confirm password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:n?"text":"password",...l("password_confirm"),disabled:r.isPending,className:"mt-2 w-full rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 dark:border-white/10 dark:bg-slate-900 dark:text-white disabled:opacity-50"}),e.jsx("button",{type:"button",onClick:()=>f(!n),className:"absolute right-3 top-[18px] text-slate-400 hover:text-white",children:n?e.jsx(p,{size:16}):e.jsx(h,{size:16})})]}),t.password_confirm&&e.jsx("p",{className:"text-xs text-red-400",children:t.password_confirm.message})]})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full",disabled:r.isPending,children:r.isPending?"Creatingâ€¦":"Create account"})]}),e.jsxs("div",{className:"flex flex-col gap-2 text-center text-sm text-slate-600 dark:text-slate-400",children:[e.jsxs("p",{children:["Already have an account?"," ",e.jsx(u,{to:"/login",className:"font-semibold text-sky-700 underline underline-offset-2 hover:text-sky-800 dark:text-sky-300 dark:hover:text-sky-200",children:"Sign in"})]}),e.jsxs("p",{children:["Are you a Visitor?"," ",e.jsx(u,{to:"/visitor-access",className:"font-semibold text-sky-700 underline underline-offset-2 hover:text-sky-800 dark:text-sky-300 dark:hover:text-sky-200",children:"Go to Visitor Access"})]})]})]})};export{R as default};
